<% title = t('banned.title'); %>
<% const showAppealSuccess = typeof appealSuccess !== "undefined" && appealSuccess; %>
<% const appealMessageValue = typeof appealMessage !== "undefined" ? appealMessage : ""; %>
<% const appealErrorMessage = typeof appealError !== "undefined" ? appealError : null; %>
<% const banSubject = ban && ban.subject ? ban.subject : 'ip'; %>
<% const isIpBan = banSubject === 'ip'; %>
<% const isUserBan = banSubject === 'user'; %>
<% const banScope = ban && ban.scope ? ban.scope : ''; %>
<% const isGlobalBan = banScope === 'global'; %>
<section class="card">
  <h1><%= t('banned.heading') %></h1>
  <p>
    <% if (isUserBan) { %>
      <% if (isGlobalBan) { %>
        <%= t('banned.user.global') %>
      <% } else { %>
        <%= t('banned.user.action') %>
      <% } %>
    <% } else { %>
      <% if (isGlobalBan) { %>
        <%= t('banned.ip.global') %>
      <% } else { %>
        <%= t('banned.ip.action') %>
      <% } %>
    <% } %>
  </p>
  <% if (ban && ban.reason) { %>
    <p><strong><%= t('banned.reasonLabel') %></strong> <%= ban.reason %></p>
  <% } %>
  <% if (showAppealSuccess) { %>
    <p class="alert alert-success"><%= t('banned.appeal.success') %></p>
  <% } else { %>
    <% if (isIpBan) { %>
      <p><%= t('banned.appeal.contactAdmin') %></p>
      <form method="post" action="/ban-appeal" class="form">
        <%- include('partials/csrf_field') %>
        <input type="hidden" name="scope" value="<%= ban?.scope || '' %>" />
        <input type="hidden" name="value" value="<%= ban?.value || '' %>" />
        <div class="form-group">
          <label for="appeal-message"><%= t('banned.appeal.label') %></label>
          <textarea
            id="appeal-message"
            name="message"
            rows="5"
            maxlength="2000"
            required
          ><%= appealMessageValue %></textarea>
        </div>
        <% if (appealErrorMessage) { %>
          <p class="form-error"><%= appealErrorMessage %></p>
        <% } %>
        <button type="submit" class="btn btn-primary"><%= t('banned.appeal.submit') %></button>
      </form>
    <% } else { %>
      <p><%= t('banned.appeal.contactAdmin') %></p>
    <% } %>
  <% } %>
</section>
