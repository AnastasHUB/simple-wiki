<% title='Utilisateurs'; %>
<h1>Utilisateurs (admins uniquement)</h1>
<form method="post" class="card">
  <div style="display:flex;gap:10px;flex-wrap:wrap">
    <input type="text" name="username" placeholder="nouvel admin" required />
    <input type="password" name="password" placeholder="mot de passe" required />
    <button class="btn success" data-icon="‚ûï">Ajouter</button>
  </div>
</form>
<% if (!users.length) { %>
  <p class="card" style="margin-top:16px;">Aucun utilisateur trouv√©.</p>
<% } else { %>
  <div class="table-wrap" style="margin-top:16px;">
    <table class="data-table">
      <thead><tr><th>ID</th><th>Nom</th><th>Admin</th><th></th></tr></thead>
      <tbody>
      <% users.forEach(u=>{ %>
        <tr>
          <td><%= u.id %></td>
          <td><%= u.username %></td>
          <td><%= u.is_admin ? 'Oui' : 'Non' %></td>
          <td>
            <form method="post" action="/admin/users/<%= u.id %>/delete" onsubmit="return confirm('Supprimer cet utilisateur ?')">
              <button class="btn danger" data-icon="üóëÔ∏è">Supprimer</button>
            </form>
          </td>
        </tr>
      <% }) %>
      </tbody>
    </table>
  </div>
  <div class="table-footer" style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:0.75rem; margin-top:1rem;">
    <form method="get" style="display:flex; align-items:center; gap:0.5rem;">
      <label for="users-per-page" style="white-space:nowrap;">√âl√©ments par page</label>
      <select id="users-per-page" name="perPage" onchange="this.form.submit()">
        <% pagination.perPageOptions.forEach(option => { %>
          <option value="<%= option %>" <%= option === pagination.perPage ? 'selected' : '' %>><%= option %></option>
        <% }) %>
      </select>
      <input type="hidden" name="page" value="1">
    </form>
    <span>Page <%= pagination.page %> sur <%= pagination.totalPages %></span>
    <div style="display:flex; gap:0.5rem;">
      <% if (pagination.hasPrevious) { %>
        <a class="btn" data-icon="‚¨ÖÔ∏è" href="?page=<%= pagination.previousPage %>&perPage=<%= pagination.perPage %>">Pr√©c√©dent</a>
      <% } else { %>
        <span class="btn" data-icon="‚¨ÖÔ∏è" aria-disabled="true" style="pointer-events:none; opacity:0.5;">Pr√©c√©dent</span>
      <% } %>
      <% if (pagination.hasNext) { %>
        <a class="btn" data-icon="‚û°Ô∏è" href="?page=<%= pagination.nextPage %>&perPage=<%= pagination.perPage %>">Suivant</a>
      <% } else { %>
        <span class="btn" data-icon="‚û°Ô∏è" aria-disabled="true" style="pointer-events:none; opacity:0.5;">Suivant</span>
      <% } %>
    </div>
  </div>
<% } %>
