<% title='Utilisateurs'; %>
<h1>Utilisateurs (admins uniquement)</h1>
<form method="post" class="card">
  <div class="flex flex-wrap gap-sm">
    <input type="text" name="username" placeholder="nouvel admin" required />
    <input type="password" name="password" placeholder="mot de passe" required />
    <button class="btn success" data-icon="‚ûï">Ajouter</button>
  </div>
</form>
<% if (!users.length) { %>
  <p class="card mt-md">Aucun utilisateur trouv√©.</p>
<% } else { %>
  <div class="table-wrap mt-md">
    <table class="data-table">
      <thead><tr><th>ID</th><th>Nom</th><th>Admin</th><th></th></tr></thead>
      <tbody>
      <% users.forEach(u=>{ %>
        <tr>
          <td><%= u.id %></td>
          <td><%= u.username %></td>
          <td><%= u.is_admin ? 'Oui' : 'Non' %></td>
          <td>
            <form method="post" action="/admin/users/<%= u.id %>/delete" onsubmit="return confirm('Supprimer cet utilisateur ?')">
              <button class="btn danger" data-icon="üóëÔ∏è">Supprimer</button>
            </form>
          </td>
        </tr>
      <% }) %>
      </tbody>
    </table>
  </div>
  <div class="table-footer">
    <form method="get">
      <label for="users-per-page" class="nowrap">√âl√©ments par page</label>
      <select id="users-per-page" name="perPage" onchange="this.form.submit()">
        <% pagination.perPageOptions.forEach(option => { %>
          <option value="<%= option %>" <%= option === pagination.perPage ? 'selected' : '' %>><%= option %></option>
        <% }) %>
      </select>
      <input type="hidden" name="page" value="1">
    </form>
    <span>Page <%= pagination.page %> sur <%= pagination.totalPages %></span>
    <div class="pager">
      <% if (pagination.hasPrevious) { %>
        <a class="btn" data-icon="‚¨ÖÔ∏è" href="?page=<%= pagination.previousPage %>&perPage=<%= pagination.perPage %>">Pr√©c√©dent</a>
      <% } else { %>
        <span class="btn" data-icon="‚¨ÖÔ∏è" aria-disabled="true">Pr√©c√©dent</span>
      <% } %>
      <% if (pagination.hasNext) { %>
        <a class="btn" data-icon="‚û°Ô∏è" href="?page=<%= pagination.nextPage %>&perPage=<%= pagination.perPage %>">Suivant</a>
      <% } else { %>
        <span class="btn" data-icon="‚û°Ô∏è" aria-disabled="true">Suivant</span>
      <% } %>
    </div>
  </div>
<% } %>
