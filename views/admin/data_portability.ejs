<h1>Import / export des données</h1>

<section class="card">
  <h2>Exporter des données</h2>
  <p class="text-muted">
    Téléchargez un fichier JSON contenant les jeux de données sélectionnés. Celui-ci peut être
    réimporté plus tard sur une autre instance du wiki.
  </p>
  <% if (!canExportData) { %>
    <div class="alert warning">Vous n'avez pas l'autorisation d'exporter des données.</div>
  <% } %>
  <form method="post" action="/admin/data/export">
    <fieldset class="field">
      <legend>Jeux de données disponibles</legend>
      <ul class="data-type-list">
        <% dataTypes.forEach((type) => { %>
          <li class="data-type-item">
            <label class="data-type-option">
              <span class="option-header">
                <input type="checkbox" name="types" value="<%= type.key %>" <%= canExportData ? '' : 'disabled' %> />
                <span class="option-title"><%= type.label %></span>
              </span>
              <% if (type.description) { %>
                <span class="option-description"><%= type.description %></span>
              <% } %>
            </label>
          </li>
        <% }); %>
      </ul>
    </fieldset>
    <fieldset class="field">
      <legend>Portée</legend>
      <label class="data-scope-option">
        <input type="radio" name="scope" value="selected" checked <%= canExportData ? '' : 'disabled' %> />
        Exporter uniquement les jeux cochés
      </label>
      <label class="data-scope-option">
        <input type="radio" name="scope" value="all" <%= canExportData ? '' : 'disabled' %> />
        Exporter tous les jeux disponibles
      </label>
    </fieldset>
    <button class="btn" type="submit" data-icon="⬇️" <%= canExportData ? '' : 'disabled' %>>Télécharger le JSON</button>
  </form>
</section>

<section class="card">
  <h2>Importer des données</h2>
  <p class="text-muted">
    Chargez un fichier exporté précédemment pour restaurer un ou plusieurs jeux de données. Les tables
    sélectionnées seront écrasées par le contenu du fichier.
  </p>
  <% if (!canImportData) { %>
    <div class="alert warning">Vous n'avez pas l'autorisation d'importer des données.</div>
  <% } %>
  <form method="post" action="/admin/data/import" enctype="multipart/form-data">
    <div class="field">
      <label for="dataFile">Fichier JSON</label>
      <input id="dataFile" type="file" name="dataFile" accept="application/json" <%= canImportData ? '' : 'disabled' %> required />
      <span class="field-hint">Seuls les exports générés depuis cette interface sont pris en charge.</span>
    </div>
    <fieldset class="field">
      <legend>Portée</legend>
      <label class="data-scope-option">
        <input type="radio" name="scope" value="selected" checked <%= canImportData ? '' : 'disabled' %> />
        Importer uniquement les jeux cochés ci-dessous
      </label>
      <label class="data-scope-option">
        <input type="radio" name="scope" value="all" <%= canImportData ? '' : 'disabled' %> />
        Importer tous les jeux présents dans le fichier
      </label>
    </fieldset>
    <fieldset class="field">
      <legend>Jeux de données à importer</legend>
      <ul class="data-type-list">
        <% dataTypes.forEach((type) => { %>
          <li class="data-type-item">
            <label class="data-type-option">
              <span class="option-header">
                <input type="checkbox" name="types" value="<%= type.key %>" <%= canImportData ? '' : 'disabled' %> />
                <span class="option-title"><%= type.label %></span>
              </span>
              <% if (type.description) { %>
                <span class="option-description"><%= type.description %></span>
              <% } %>
            </label>
          </li>
        <% }); %>
      </ul>
      <span class="field-hint">Les jeux non cochés seront ignorés lors de l'import.</span>
    </fieldset>
    <button class="btn" type="submit" data-icon="⬆️" <%= canImportData ? '' : 'disabled' %>>Lancer l'import</button>
  </form>
</section>
