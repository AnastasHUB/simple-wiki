<%
  const reactionList = Array.isArray(reactions) ? reactions : [];
  const showLabels = !condensed;
  const reactionSlug = typeof slug !== 'undefined' && slug ? slug : null;
  const reactionCommentId = typeof commentId !== 'undefined' && commentId ? commentId : null;
%>
<% if (reactionList.length) { %>
  <form
    class="reaction-form <%= condensed ? 'reaction-form--compact' : '' %>"
    method="post"
    action="<%= formAction %>"
    data-reaction-form
    data-reaction-target="<%= target %>"
    <%= reactionSlug ? `data-reaction-slug="${reactionSlug}"` : '' %>
    <%= reactionCommentId ? `data-comment-id="${reactionCommentId}"` : '' %>
  >
    <%- include('csrf_field') %>
    <% reactionList.forEach((reaction) => { %>
      <%
        const buttonClasses = ['reaction-button'];
        if (reaction.reacted) {
          buttonClasses.push('is-active');
        }
        const labelClasses = ['reaction-label'];
        if (!showLabels) {
          labelClasses.push('sr-only');
        }
      %>
      <button
        type="submit"
        name="reaction"
        value="<%= reaction.id %>"
        class="<%= buttonClasses.join(' ') %>"
        data-reaction-option
        data-reaction-key="<%= reaction.id %>"
        aria-pressed="<%= reaction.reacted ? 'true' : 'false' %>"
        title="<%= reaction.label %>"
      >
        <span class="reaction-icon" aria-hidden="true">
          <% if (reaction.imageUrl) { %>
            <img src="<%= reaction.imageUrl %>" alt="" loading="lazy" />
          <% } else { %>
            <%= reaction.emoji || 'ðŸ™‚' %>
          <% } %>
        </span>
        <span class="<%= labelClasses.join(' ') %>"><%= reaction.label %></span>
        <span class="reaction-count" data-reaction-count><%= reaction.count %></span>
      </button>
    <% }) %>
  </form>
<% } %>
