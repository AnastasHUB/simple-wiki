<% title = 'Accueil'; %>
<h1>Derniers articles (‚â§ 7 jours)</h1>
<div class="article-grid">
  <% if (recent.length === 0) { %><div class="card">Aucun article r√©cent.</div><% } %>
  <% recent.forEach(p => { const tags = (p.tagsCsv||'').split(',').filter(Boolean); %>
    <div class="card">
      <h3><strong><%= p.title %></strong></h3>
      <% if (p.excerpt) { %>
        <div class="excerpt">
          <div class="excerpt-body"><%- p.excerpt %></div>
        </div>
      <% } %>
      <% if (tags.length) { %>
        <div class="tags-row">
          <% tags.forEach(t => { %><a class="tag" href="/tags/<%= t %>"><%= t %></a><% }) %>
        </div>
      <% } %>
      <div class="actions">
        <a class="btn success" href="/wiki/<%= p.slug_id %>">Ouvrir l‚Äôarticle</a>
        <form action="/wiki/<%= p.slug_id %>/like" method="post">
          <% if (p.userLiked) { %>
            <button class="btn unlike">‚ùå Retirer (<%= p.likes %>)</button>
          <% } else { %>
            <button class="btn like">üëç Like (<%= p.likes %>)</button>
          <% } %>
        </form>
        <button class="btn copy" onclick="navigator.clipboard.writeText(location.origin + '/wiki/<%= p.slug_id %>')">Copier le lien</button>
      </div>
      <small>Publi√©: <%= p.created_at %></small>
    </div>
  <% }) %>
</div>

<h2>Articles</h2>
<div class="article-grid">
  <% rows.forEach(p => { const tags = (p.tagsCsv||'').split(',').filter(Boolean); %>
    <div class="card">
      <h3><strong><%= p.title %></strong></h3>
      <% if (p.excerpt) { %>
        <div class="excerpt">
          <div class="excerpt-body"><%- p.excerpt %></div>
        </div>
      <% } %>
      <% if (tags.length) { %>
        <div class="tags-row">
          <% tags.forEach(t => { %><a class="tag" href="/tags/<%= t %>"><%= t %></a><% }) %>
        </div>
      <% } %>
      <div class="actions">
        <a class="btn success" href="/wiki/<%= p.slug_id %>">Ouvrir l‚Äôarticle</a>
        <form action="/wiki/<%= p.slug_id %>/like" method="post">
          <% if (p.userLiked) { %>
            <button class="btn unlike">‚ùå Retirer (<%= p.likes %>)</button>
          <% } else { %>
            <button class="btn like">üëç Like (<%= p.likes %>)</button>
          <% } %>
        </form>
        <button class="btn copy" onclick="navigator.clipboard.writeText(location.origin + '/wiki/<%= p.slug_id %>')">Copier le lien</button>
      </div>
      <small>Publi√©: <%= p.created_at %></small>
    </div>
  <% }) %>
</div>

<div class="actions">
  <% if (page > 1) { %><a class="btn" href="/?page=<%= page-1 %>">Pr√©c√©dent</a><% } %>
  <span>Page <%= page %> / <%= totalPages %></span>
  <% if (page < totalPages) { %><a class="btn" href="/?page=<%= page+1 %>">Suivant</a><% } %>
</div>
