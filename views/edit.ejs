<% title = page ? 'Ã‰diter' : 'Nouvelle page'; %>
<h1><%= title %></h1>
<% const isSubmission = typeof submissionMode !== 'undefined' ? submissionMode : false; %>
<% const authorFieldValue = typeof authorName !== 'undefined'
  ? authorName
  : (page && page.author ? page.author : ''); %>
<% if (isSubmission) { %>
  <div class="card card-highlight mb-md">
    <p class="mt-0 mb-0">
      Votre proposition sera enregistrÃ©e avec votre adresse IP et un administrateur devra la valider avant publication.
    </p>
  </div>
<% } %>
<form method="post">
  <label>Titre</label>
  <input type="text" name="title" value="<%= page ? page.title : '' %>" required />
  <label>Contenu (liens [[internes]])</label>
  <textarea name="content" id="contentField" rows="18" required hidden><%- page ? page.content : '' %></textarea>
  <div class="html-editor-shell">
    <div class="html-editor-toolbar" id="editorToolbar">
      <span class="ql-formats">
        <select class="ql-header" aria-label="Niveau de titre">
          <option selected></option>
          <option value="1">Titre principal</option>
          <option value="2">Titre moyen</option>
          <option value="3">Sous-titre</option>
        </select>
        <button class="ql-bold" aria-label="Gras"></button>
        <button class="ql-italic" aria-label="Italique"></button>
        <button class="ql-underline" aria-label="SoulignÃ©"></button>
        <button class="ql-strike" aria-label="BarrÃ©"></button>
      </span>
      <span class="ql-formats">
        <button class="ql-list" value="ordered" aria-label="Liste numÃ©rotÃ©e"></button>
        <button class="ql-list" value="bullet" aria-label="Liste Ã  puces"></button>
        <button class="ql-list" value="check" aria-label="Liste de tÃ¢ches"></button>
        <button class="ql-indent" value="-1" aria-label="Diminuer le retrait"></button>
        <button class="ql-indent" value="+1" aria-label="Augmenter le retrait"></button>
      </span>
      <span class="ql-formats">
        <button class="ql-script" value="sub" aria-label="Indice"></button>
        <button class="ql-script" value="super" aria-label="Exposant"></button>
        <button class="ql-blockquote" aria-label="Bloc de citation"></button>
        <button class="ql-code-block" aria-label="Bloc de code"></button>
        <button type="button" class="ql-divider" aria-label="SÃ©paration"></button>
      </span>
      <span class="ql-formats">
        <button class="ql-link" aria-label="InsÃ©rer un lien"></button>
        <button class="ql-image" aria-label="InsÃ©rer une image"></button>
        <button class="ql-clean" aria-label="Effacer la mise en forme"></button>
      </span>
    </div>
    <div
      class="html-editor"
      data-html-editor
      data-target="#contentField"
      data-toolbar="#editorToolbar"
      <% if (typeof allowUploads !== 'undefined' && allowUploads) { %>data-upload-endpoint="/admin/uploads"<% } %>
      aria-label="Ã‰diteur de contenu"
    ></div>
  </div>
  <p class="editor-hint">
    Astuce : utilisez <code>[[Titre de page]]</code> pour crÃ©er des liens internes rapides.
  </p>
  <label for="author-field">Auteur affichÃ©</label>
  <input
    id="author-field"
    type="text"
    name="author"
    maxlength="80"
    value="<%= authorFieldValue %>"
    placeholder="Votre nom ou pseudo"
  />
  <p class="editor-hint">
    Ce nom sera affichÃ© comme auteur de lâ€™article. Si vous nâ€™Ãªtes pas connectÃ©, choisissez le pseudo de votre choix.
  </p>
  <label>Tags (sÃ©parÃ©s par des virgules)</label>
  <input type="text" name="tags" value="<%= tags %>" />
  <div class="actions">
    <% if (isSubmission) { %>
      <button class="btn success" data-icon="ğŸ“¨" type="submit">Envoyer ma proposition</button>
    <% } else { %>
      <button class="btn success" data-icon="ğŸ’¾" type="submit">Enregistrer</button>
    <% } %>
  </div>
</form>

