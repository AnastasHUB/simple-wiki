<% title = 'Tag Â· ' + tag; %>
<h1>Tag: <%= tag %></h1>
<div class="article-grid">
  <% if (!pages.length) { %><div class="card">Aucun article.</div><% } %>
  <% pages.forEach(p => { const tags = (p.tagsCsv||'').split(',').filter(Boolean); %>
    <div class="card">
      <h3><strong><%= p.title %></strong></h3>
      <% if (p.excerpt) { %>
        <div class="excerpt">
          <div class="excerpt-body"><%- p.excerpt %></div>
        </div>
      <% } %>
      <% if (tags.length) { %>
        <div class="tags-row">
          <% tags.forEach(t => { %><a class="tag" href="/tags/<%= t %>"><%= t %></a><% }) %>
        </div>
      <% } %>
      <div class="page-stats" aria-label="Statistiques de lâ€™article">
        <span title="Likes">ğŸ’– <strong data-like-count-for="<%= p.slug_id %>"><%= p.likes %></strong></span>
        <span title="Commentaires">ğŸ’¬ <strong><%= p.comment_count %></strong></span>
        <span title="Vues">ğŸ‘ï¸ <strong><%= p.views %></strong></span>
      </div>
      <div class="actions">
        <a class="btn success" data-icon="ğŸ“–" href="/wiki/<%= p.slug_id %>">Ouvrir lâ€™article</a>
        <form action="/wiki/<%= p.slug_id %>/like" method="post" data-like-form-for="<%= p.slug_id %>">
          <button
            class="btn <%= p.userLiked ? 'unlike' : 'like' %>"
            data-icon="<%= p.userLiked ? 'ğŸ’”' : 'ğŸ’–' %>"
            data-label-liked="Retirer"
            data-label-unliked="Like"
            type="submit"
          >
            <%= p.userLiked ? 'Retirer' : 'Like' %> (<%= p.likes %>)
          </button>
        </form>
        <button class="btn copy" data-icon="ğŸ”—" onclick="navigator.clipboard.writeText(location.origin + '/wiki/<%= p.slug_id %>')">Copier le lien</button>
      </div>
    </div>
  <% }) %>
</div>
