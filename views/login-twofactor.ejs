<% title = 'V√©rification en deux √©tapes'; %>
<h1>V√©rification en deux √©tapes</h1>
<p>
  Saisissez le code TOTP g√©n√©r√© par votre application d'authentification pour finaliser votre connexion, <strong><%= username %></strong>.
</p>
<% if (error) { %>
  <div class="card alert error"><%= error %></div>
<% } %>
<form method="post" action="/login/two-factor" class="card form">
  <%- include('partials/csrf_field') %>
  <input type="hidden" name="mode" value="totp" />
  <div class="field">
    <label for="twofactor-token">Code TOTP</label>
    <input
      id="twofactor-token"
      name="token"
      type="text"
      inputmode="numeric"
      autocomplete="one-time-code"
      pattern="\\d{6}"
      required
      placeholder="123456"
    />
  </div>
  <div class="actions">
    <button class="btn success" data-icon="‚úÖ">Valider</button>
  </div>
</form>

<% if (remainingRecoveryCodes > 0) { %>
  <section class="card">
    <h2>Vous n'avez pas acc√®s √† votre application ?</h2>
    <p>
      Utilisez l'un de vos codes de r√©cup√©ration. Il vous restera ensuite <strong><%= remainingRecoveryCodes %></strong> code(s).
    </p>
    <form method="post" action="/login/two-factor" class="form recovery-form">
      <%- include('partials/csrf_field') %>
      <input type="hidden" name="mode" value="recovery" />
      <div class="field">
        <label for="recovery-code">Code de r√©cup√©ration</label>
        <input
          id="recovery-code"
          name="recoveryCode"
          type="text"
          required
          placeholder="EXEMPLE-12345"
        />
      </div>
      <div class="actions">
        <button class="btn" data-icon="üîÅ">Valider avec un code de r√©cup√©ration</button>
      </div>
    </form>
  </section>
<% } else { %>
  <p class="text-muted">
    Tous vos codes de r√©cup√©ration ont d√©j√† √©t√© utilis√©s. Contactez un administrateur si vous ne pouvez pas acc√©der √† votre application.
  </p>
<% } %>
